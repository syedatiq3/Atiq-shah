/* Use of this pixel is subject to the Amazon ad specs and policies at http://www.amazon.com/b/?&node=7253015011 */
!function(){"use strict";var e=40,t=25,n=100,o=/[-’/`~!#*$@%+=.,^&(){}[\]|;:”<>?\\]/g,a="Event name is longer than 40 characters.",r="Event name may not contain special characters.",s="Number of parameters exceeds 25.",i="Parameter name may not contain special characters.",c="Parameter value may not contain special characters.",p="Length of parameter name exceeds 40 characters.",d="Length of parameter value exceeds 100 characters.",h="Length of parameter key exceeds 40 characters.";function u(e){this.endpoints=e,this.region="NA",this.stage="PROD",this.tags={},this.tcfv2={}}u.prototype.addTag=function(e,t){var n=null==t?e:t;this.tags[n]=e},u.prototype.getTagIds=function(e){var t=this.tags;return e.map((function(e){return t[e]||e}))},u.prototype.trackEvent=function(e,t,n){this.trackEventWithTags(e,t,n,Object.keys(this.tags))},u.prototype.trackEventWithTags=function(u,l,f,g){var k=this.getPixelEndpoint(this.region,this.stage),m=this.tcfv2;l=l||{},console.log("Event: ",u),console.log("Pixel Endpoint: ",k),u?k?(f&&(l.ts=f),this.getTagIds(g).forEach((function(f){!function(u,l,f,g,k){var m=document.createElement("iframe"),v=u+"?pid="+l+"&event="+f,y=["gdpr","gdpr_pd","gdpr_consent"],T=o,E=[];if(f.length>e&&E.push(`${a}, ${f}`),T.test(f)&&E.push(`${r}, ${f}`),Array.isArray(g)?(g.length>t&&E.push(`${s}, ${g.length}`),g.forEach((function(t){T.test(Object.keys(t)[0])&&E.push(`${i}, ${Object.keys(t)[0]}`),T.test(t[Object.keys(t)[0]])&&E.push(`${c}, ${t[Object.keys(t)[0]]}`),Object.keys(t)[0].length>e&&E.push(`${p}, ${Object.keys(t)[0]}`),t[Object.keys(t)[0]].length>n&&E.push(`${d}, ${t[Object.keys(t)[0]]}`)})),v+="&items="+encodeURI(JSON.stringify(g))):g&&Object.keys(g)&&(Object.keys(g).length>t&&E.push(`${s}, ${Object.keys(g).length}`),Object.keys(g).filter((function(e){return!y.includes(e)})).forEach((function(t){var o;t.length>e&&E.push(`${p}, ${t}`),T.test(t)&&E.push(`${i}, ${t}`),(o=g[t])?(o.length>n&&E.push(`${d}, ${o}`),"string"==typeof o?T.test(o)&&E.push(`${c}, ${o}`):Object.keys(o)&&Object.keys(o)[0]&&Object.keys(o).forEach((function(t){t.length>e&&E.push(`${h}, ${t}`),o[t].length>n&&E.push(`${d}, ${o[t]}`),T.test(t)&&E.push(`${i}, ${t}`),T.test(o[t])&&E.push(`${c}, ${o[t]}`)})),"object"==typeof o&&(o=encodeURI(JSON.stringify(o))),v+="&"+t+"="+o):E.push("Key "+t+" has no value")}))),E.length>0)return console.warn(`Event has ${E.length} validation errors.`),void console.warn(E);if(k&&y.forEach((function(e){k[e]&&(v+="&"+e+"="+k[e])})),document.cookie.indexOf("amznToken")>=0){const e=document.cookie.split(";").find(e=>e.trim().startsWith("amznToken="));if(void 0!==e){const t=e.substring(e.indexOf("=")+1);v+="&amznToken="+t}}m.style.display="none",m.setAttribute("src",v),m.setAttribute("id","tag_fire_"+l+"_"+f),document.body.appendChild(m)}(k,f,u,l,m[f])}))):console.warn("No valid endpoint."):console.warn("No event specified.")},u.prototype.trackPixel=function(e,t,n){var o=this,a={};((t=(t=t||"").split("?")).length>1?t[1]:t[0]).split("&").forEach((function(e){var t,n,r=e.split("=");r.length<=1||("ex-fargs"===r[0]?(t=o.parsePixelArgs(r[1],"&"),a.fargs_id=t.id,a.fargs_type=t.type):"ex-hargs"===r[0]&&(n=o.parsePixelArgs(r[1],";"),a.hargs_c=n.c,a.hargs_p=n.p))})),this.validatePixelData(a),Object.keys(a).forEach((function(e){a[e]||delete a[e]})),this.trackEvent(e,a,n)},u.prototype.addTcfv2=function(e){this.addTcfv2WithTags(e,Object.keys(this.tags))},u.prototype.addTcfv2WithTags=function(e,t){var n=this.tcfv2;this.getTagIds(t).forEach((function(t){n[t]=e}))},u.prototype.getPixelEndpoint=function(e,t){var n,o=this.endpoints[e];return""===o||null==o?(console.warn("Endpoint does not exist, please check your region configuration!"),null):""===(n=o[t])||null==n?(console.warn("Endpoint does not exist, please check your stage configuration!"),null):n},u.prototype.parsePixelArgs=function(e,t){var n=decodeURIComponent(e),o={};return(n=n.replace(/\?/g,"")).split(t).forEach((function(e){(e=e.split("=")).length>1&&(o[e[0]]=e[1])})),o},u.prototype.validatePixelData=function(e){var t=e.hargs_c&&e.hargs_p,n=e.fargs_id&&e.fargs_type;t||n||console.warn("Invalid arguments for a trackPixel event, please check your implementation!")},u.prototype.setRegion=function(e){this.region=e},u.prototype.setStage=function(e){this.stage=e};var l=u,f=["AddToShoppingCart","Application","Checkout","Contact","Lead","Off-AmazonPurchases","Search","Signup","Subscribe"];function g(e){this.AD_TAG_HTML_PREFIX="amzn-ad-tag-",this.AD_TAG_EVENT_NAMES=f,this.eventTracker=e}g.prototype.init=function(){var e=this.eventTracker;this.AD_TAG_EVENT_NAMES.forEach((function(t){var n="amzn-ad-tag-"+t;document.getElementById(n)&&document.getElementById(n).addEventListener("click",(function(){e.trackEvent(t,{},(new Date).getTime())}))}))},g.prototype.addEventName=function(e){-1===f.indexOf(e)&&f.push(e)},g.prototype.overrideEventPrefix=function(e){this.AD_TAG_HTML_PREFIX=e},g.prototype.overrideEventName=function(e,t){var n=f.indexOf(e);-1!==n&&(f[n]=t)};var k=g;function m(e,t,n){this.eventTracker=e,this.eventListener=t,this.setUserDataHandler=n}m.prototype.proccessCommandQueue=function(e){var t=this;(e||[]).forEach((function(e){t.proccessCommand(e[0],e[1])}))},m.prototype.proccessCommand=function(e,t){var n=Array.prototype.slice.call(e),o=e[0];switch(t=t||(new Date).getTime(),o.toUpperCase()){case"TRACKEVENT":this.trackEvent(n,t);break;case"TRACKPIXEL":this.trackPixel(n,t);break;case"PIXEL":case"WITHTAG":this.withTag(n,t);break;case"ADDPIXEL":case"ADDTAG":this.addTag(n);break;case"ADDTCFV2":this.addTcfv2(n);break;case"SETREGION":this.setRegion(n);break;case"SETSTAGE":this.setStage(n);break;case"LISTEN":this.listen();break;case"OVERRIDE_EVENT_NAME":this.overrideEventname(n);break;case"OVERRIDE_EVENT_PREFIX":this.overrideEventPrefix(n);break;case"ADD_CUSTOM_EVENT":this.addCustomEvent(n);break;case"SETUSERDATA":this.setUserData(n);break;default:console.warn('Unsupported tag command "'+o+'"')}},m.prototype.setUserData=async function(e){this.setUserDataHandler.setUserData(e)},m.prototype.addCustomEvent=function(e){var t=e[1];this.eventListener.addEventName(t)},m.prototype.overrideEventPrefix=function(e){var t=e[1];this.eventListener.overrideEventPrefix(t)},m.prototype.overrideEventname=function(e){var t=e[1],n=e[2];this.eventListener.overrideEventName(t,n)},m.prototype.trackEvent=function(e,t,n){var o=e[1],a=e[2];void 0!==n?this.eventTracker.trackEventWithTags(o,a,t,[n]):this.eventTracker.trackEvent(o,a,t)},m.prototype.trackPixel=function(e,t){this.eventTracker.trackPixel("__pixel__",e[1],t)},m.prototype.withTag=function(e,t){var n=e[1],o=e[2]||"";switch(o.toUpperCase()){case"TRACKEVENT":this.trackEvent(e.slice(2),t,n);break;case"ADDTCFV2":this.addTcfv2(e.slice(2),n);break;default:console.warn('Unsupported command "'+o+'" used after "withTag" command')}},m.prototype.addTag=function(e){var t=e[2],n=e[1];this.eventTracker.addTag(n,t)},m.prototype.addTcfv2=function(e,t){var n=e[1];void 0!==t?this.eventTracker.addTcfv2WithTags(n,[t]):this.eventTracker.addTcfv2(n)},m.prototype.setRegion=function(e){var t=e[1].toUpperCase();this.eventTracker.setRegion(t)},m.prototype.setStage=function(e){var t=e[1].toUpperCase();this.eventTracker.setStage(t)},m.prototype.listen=function(){this.eventListener.init()};var v=m;const y={method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer-when-downgrade"};function T(){}T.prototype.formatRequestBody=function(e){const t={};if(null!==e.gdpr&&(t.gdpr=e.gdpr.enabled?1:0,null!==e.gdpr.consent&&(t.gdprConsent=e.gdpr.consent)),null===e.hashedRecords)throw Error("hashedRecords array is null");if(0===e.hashedRecords.length)throw Error("hashedRecords array is empty");return t.hashedRecords=e.hashedRecords,null!==e.ttl&&(t.ttl=e.ttl),t},T.prototype.requestToken=async function(e){const t={...y,body:JSON.stringify(e)},n=await fetch("https://tk.amazon-adsystem.com/envelope",t);if(n.ok){return await n.json()}const o=await n.text();throw Error(o)},T.prototype.isCookiePresent=function(e){return void 0!==document.cookie.split(";").find(t=>t.trim().startsWith(e+"="))},T.prototype.writeCookie=function(e,t,n){const o=new Date(n).toUTCString();document.cookie=`${e}=${t}; expires=${o}; SameSite=Strict; secure=true;`},T.prototype.renewToken=async function(e){if(!this.isCookiePresent("amznToken")&&!this.isCookiePresent("AMZN-NoCookieConsent"))try{const t=this.formatRequestBody(e),n=await this.requestToken(t);""===n.AIPToken?this.writeCookie("AMZN-NoCookieConsent",n.AIPToken,n.cookieExpiry):this.writeCookie("amznToken",n.AIPToken,n.cookieExpiry)}catch(e){console.error(e)}},T.prototype.deleteToken=async function(){this.isCookiePresent("amznToken")&&this.writeCookie("amznToken","0",1),this.isCookiePresent("AMZN-NoCookieConsent")&&this.writeCookie("AMZN-NoCookieConsent","0",1)},T.prototype.updateToken=async function(e){await this.deleteToken(),await this.renewToken(e)};var E=T;function w(e){this.tokenHandler=e}E.TOKEN_COOKIE_NAME="amznToken",E.NO_CONSENT_COOKIE_NAME="AMZN-NoCookieConsent",w.prototype.setUserData=async function(e){const t={gdpr:{enabled:!1,consent:""},hashedRecords:[{type:"email",record:""}],ttl:9600};var n=e[1];n.gdpr&&(t.gdpr=n.gdpr),n.ttl&&(t.ttl=n.ttl);const o=new RegExp("\\b[A-Fa-f0-9]{64}\\b");null!==n.email&&(n.email=n.email.trim().toLowerCase(),o.test(n.email)?t.hashedRecords[0].record=n.email:await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(n.email).then(e=>{t.hashedRecords[0].record=e})),this.tokenHandler.updateToken(t)};var A,C,b,O,N,P=w;A=new l({NA:{TEST:"https://s.amazon-adsystem.com/iu3",BETA:"https://s-beta.amazon-adsystem.com/iu3",GAMMA:"https://s-preprod.amazon-adsystem.com/iu3",PROD:"https://s.amazon-adsystem.com/iu3"},EU:{BETA:"",GAMMA:"",PROD:"https://aax-eu.amazon-adsystem.com/s/iu3"},FE:{BETA:"",GAMMA:"",PROD:"https://aax-fe.amazon-adsystem.com/s/iu3"}}),C=new E,b=new P(C),O=new k(A,b),N=new v(A,O,b),window.amzn&&window.amzn.q&&N.proccessCommandQueue(window.amzn.q),window.amzn=function(){N.proccessCommand(arguments)},window.renewToken=function(e){C.renewToken(e)},window.updateToken=function(e){C.updateToken(e)},window.deleteToken=function(){C.deleteToken()}}();
